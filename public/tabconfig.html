<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license. -->
<!-- See LICENSE in the project root for license information -->

<!DOCTYPE html>
<html>
  <body>
    <form>
      <p style="background-color: #ececf9; padding: 5px;"> ChartID: <input type="text" id="chartID" name="chartID" value="chartID" size="40" onclick="onClick()">
      <br>
      <input type="radio" name="access" value="read" onclick="onClick()"> Read
      <br>
      <input type="radio" name="access" value="edit" onclick="onClick()"> Edit
      </p>
    </form>

    <script src="https://statics.teams.microsoft.com/sdk/v0.3/js/MicrosoftTeams.min.js"></script>

    <script type="text/javascript">
       microsoftTeams.initialize();
       microsoftTeams.settings.registerOnSaveHandler(function(saveEvent) {
          var input = document.getElementById('chartID');
          var id = input.value;
          //e5eee740-76f7-4027-837f-27920a52b899#
         var radios = document.getElementsByName('access');
         var url = "";
         if(radios[0].checked){ //Read Only
           url = "https://www.lucidchart.com/documents/view/" + id;
         }
         else{ //Edit
           url = "https://www.lucidchart.com/documents/edit/" + id; 
         }
         
         
          microsoftTeams.settings.setSettings({
            contentUrl: url,
            suggestedTabName: "LucidChart",
            websiteUrl: url,
            removeUrl: "https://coreybmt.github.io/LucidChartTab/public/tabremove.html"
          });
       
         saveEvent.notifySuccess();
       });

       function onClick() {
         microsoftTeams.settings.setValidityState(true);
      }
    </script>
  </body>
</html>
